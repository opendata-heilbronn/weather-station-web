<html><head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
        <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="bootstrap.css" rel="stylesheet" type="text/css">
        <script src="d3.v3.min.js" language="JavaScript"></script>
		<script src="liquidFillGauge.js" language="JavaScript"></script>
		<script src="moment.js" language="JavaScript"></script>
		<style>
			.liquidFillGaugeText { font-size: 34px; }

			.axis path,
			.axis line {
				fill: none;
				stroke: #000;
				shape-rendering: crispEdges;
			}

			.line {
				fill: none;
				stroke: steelblue;
				stroke-width: 1.5px;
			}

		</style>
    </head><body>

<div class="navbar navbar-default navbar-inverse navbar-static-top">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-ex-collapse">
				<span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span>
				<span class="icon-bar"></span></button>
				<a class="navbar-brand" href="#"><span>Sensoren</span></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-ex-collapse">
				<ul class="nav navbar-nav navbar-right">
					<li class="active">
						<a href="http://coworking-heilbronn.org/"><i class="fa fa-fw text-warning fa-home"></i>Home</a>
					</li>
					<li>
						<a href="#statistik">Statistiken</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="section">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<h1>Coworking Space Heilbronn - <span class="text-danger">Sensordaten</span></h1>
				</div>
			</div>
		</div>
	</div>
	<hr>
	<div class="section">
		<div class="container">
			<div class="row" style="margin-bottom: 20px">
				<h2 class="text-center">Temperaturen</h2>
			</div>
			<div class="row">
				<div class="col-md-4">
					<svg id="sensorOutsideGauge" width="97%" height="250" onclick="NewValueOutside();"></svg>
					<h3 style="font-family: PT Mono" class="text-center">Außen</h3>
					<div id="sensorOutsideLastUpdate" class="text-center"></div>
				</div>
				<div class="col-md-4">
					<svg id="sensorSouthGauge" width="97%" height="250" onclick="NewValueSouth();"></svg>
					<h3 style="font-family: PT Mono" class="text-center">Innen (Süd)</h3>
					<div id="sensorSouthLastUpdate" class="text-center"></div>
				</div>
				<div class="col-md-4">
					<svg id="sensorNorthGauge" width="97%" height="250" onclick="NewValueNorth();"></svg>
					<h3 style="font-family: PT Mono" class="text-center">Innen (Nord)</h3>
					<div id="sensorNorthLastUpdate" class="text-center"></div>
				</div>
			</div>
		</div>
	</div>
	<hr>
	<div class="section">
		<div class="container">
			<div class="row" style="margin-bottom: 20px">
				<h2 class="text-center">Luftfeuchtigkeit</h2>
			</div>
			<div class="row">
				<div class="col-md-12">
					<svg id="sensorInsideHumidityGauge" width="97%" height="200" onclick="NewValueInsideHumidity();"></svg>
					<h3 style="font-family: 'PT Mono'" class="text-center">Innen</h3>
					<div id="sensorHumidityLastUpdate" class="text-center"></div>
				</div>
			</div>
		</div>
	</div>
	<hr>
	<div class="section" id="statistik">
		<div class="container">
			<div class="row" style="margin-bottom: 20px">
				<h2 class="text-center">Temperatur-Statistiken <small>(letzte Woche)</small></h2>
			</div>
			<div class="row">
				<div id="stats" class="col-md-12">
				</div>
			</div>
		</div>
	</div>
	<div class="section" id="dust-statistik">
		<div class="container">
			<div class="row" style="margin-bottom: 20px">
				<h2 class="text-center">Staub-Statistiken (Color Laser Jet Enterprise M553) <small>(letzte Woche)</small></h2>
			</div>
			<div class="row">
				<div id="duststats" class="col-md-12">
				</div>
			</div>
		</div>
	</div>
	<div class="section" id="dust-statistik-today">
		<div class="container">
			<div class="row" style="margin-bottom: 20px">
				<h2 class="text-center">Staub-Statistiken (Color Laser Jet Enterprise M553) <small>(letzte Woche, pro Tag)</small></h2>
			</div>
			<div class="row">
				<div id="duststatstoday" class="col-md-12">
				</div>
			</div>
		</div>
	</div>
	<div class="section" id="humidity-statistik">
		<div class="container">
			<div class="row" style="margin-bottom: 20px">
				<h2 class="text-center">Luftfeuchtigkeit-Statistiken <small>(letzte Woche)</small></h2>
			</div>
			<div class="row">
				<div id="humiditystats" class="col-md-12">
				</div>
			</div>
		</div>
	</div>
	<hr>
	<center>
		Made with <i class="fa fa-heart"></i> by <a href="https://github.com/opendata-heilbronn/weather-station-web">Opendata Heilbronn <i class="fa fa-github"></i></a>
	</center>

<script language="JavaScript">

	var textColor = "#3B3B3B";
	
	// SENSOR NORTH
    var northConfig = liquidFillGaugeDefaultSettings();
    northConfig.circleColor = "#5DCFDC";
    northConfig.textColor = textColor;
    northConfig.waveTextColor = textColor;
    northConfig.waveColor = "#DADC5D";
    northConfig.circleThickness = 0.1;
    northConfig.circleFillGap = 0.2;
    northConfig.textVertPosition = 0.8;
    northConfig.waveAnimateTime = 1200;
    northConfig.waveHeight = 0.08;
    northConfig.displayPercent = false;
    var northGauge= loadLiquidFillGauge("sensorNorthGauge", 0.0, northConfig);
    
    function NewValueNorth(){
        var request = new XMLHttpRequest();
		request.open('GET', 'http://api.grundid.de/sensor?sensorName=cowo.inside2.temperature&size=1', true);
	
		request.onload = function() {
			if (request.status >= 200 && request.status < 400) {
				var data = JSON.parse(request.responseText);
				var sensorValue = data.content[0].value;
				northGauge.update(sensorValue);
				$('#sensorNorthLastUpdate').text(moment(data.content[0].date).format('LLLL'));
			} else {
				
			}	
		};

		request.onerror = function() {
		};

		request.send();

    }

    // SENSOR SOUTH
    var southConfig = liquidFillGaugeDefaultSettings();
    southConfig.circleColor = "#5DCFDC";
    southConfig.textColor = textColor;
    southConfig.waveTextColor = textColor;
    southConfig.waveColor = "#DADC5D";
    southConfig.circleThickness = 0.1;
    southConfig.circleFillGap = 0.2;
    southConfig.textVertPosition = 0.8;
    southConfig.waveAnimateTime = 1200;
    southConfig.waveHeight = 0.08;
    southConfig.displayPercent = false;
    var southGauge= loadLiquidFillGauge("sensorSouthGauge", 0.0, southConfig);
    
    function NewValueSouth(){
        var request = new XMLHttpRequest();
		request.open('GET', 'http://api.grundid.de/sensor?sensorName=cowo.inside1.temperature&size=1', true);
	
		request.onload = function() {
			if (request.status >= 200 && request.status < 400) {
				var data = JSON.parse(request.responseText);
				var sensorValue = data.content[0].value;
				southGauge.update(sensorValue);
				$('#sensorSouthLastUpdate').text(moment(data.content[0].date).format('LLLL'));
			} else {
				
			}	
		};

		request.onerror = function() {
		};

		request.send();

    }

    // SENSOR OUTSIDE
    var outsideConfig = liquidFillGaugeDefaultSettings();
    outsideConfig.circleColor = "#5DCFDC";
    outsideConfig.textColor = textColor;
    outsideConfig.waveTextColor = textColor;
    outsideConfig.waveColor = "#DADC5D";
    outsideConfig.circleThickness = 0.1;
    outsideConfig.circleFillGap = 0.2;
    outsideConfig.textVertPosition = 0.8;
    outsideConfig.waveAnimateTime = 1200;
    outsideConfig.waveHeight = 0.08;
    outsideConfig.displayPercent = false;
    var outsideGauge= loadLiquidFillGauge("sensorOutsideGauge", 0.0, outsideConfig);
    
    function NewValueOutside(){
        var request = new XMLHttpRequest();
		request.open('GET', 'http://api.grundid.de/sensor?sensorName=cowo.outside.temperature&size=1', true);
	
		request.onload = function() {
			if (request.status >= 200 && request.status < 400) {
				var data = JSON.parse(request.responseText);
				var sensorValue = data.content[0].value;
				outsideGauge.update(sensorValue);
				$('#sensorOutsideLastUpdate').text(moment(data.content[0].date).format('LLLL'));

			} else {
				
			}	
		};

		request.onerror = function() {
		};

		request.send();

    }

    
    // SENSOR INSIDE HUMIDITY
    var insideHumidityConfig = liquidFillGaugeDefaultSettings();
	insideHumidityConfig.circleColor = "#6EA164";
	insideHumidityConfig.textColor = textColor;
	insideHumidityConfig.waveTextColor = textColor;
	insideHumidityConfig.waveColor = "#5EB3DA";
	insideHumidityConfig.circleThickness = 0.1;
	insideHumidityConfig.circleFillGap = 0.2;
	insideHumidityConfig.textVertPosition = 0.8;
	insideHumidityConfig.waveAnimateTime = 1100;
	insideHumidityConfig.waveHeight = 0.12;
    var insideHumidityGauge= loadLiquidFillGauge("sensorInsideHumidityGauge", 0.0, insideHumidityConfig);
    
    function NewValueInsideHumidity(){
        var request = new XMLHttpRequest();
		request.open('GET', 'http://api.grundid.de/sensor?sensorName=cowo.inside3.humidity&size=1', true);
	
		request.onload = function() {
			if (request.status >= 200 && request.status < 400) {
				var data = JSON.parse(request.responseText);
				var sensorValue = data.content[0].value;
				insideHumidityGauge.update(sensorValue);
				$('#sensorHumidityLastUpdate').text(moment(data.content[0].date).format('LLLL'));

			} else {
				
			}	
		};

		request.onerror = function() {
		};

		request.send();
    }

	function updateValues(){
		NewValueNorth();
		NewValueSouth();
		NewValueOutside();
		NewValueInsideHumidity();
	}
	updateValues();
	setTimeout(updateValues, 1000 * 60 * 3);
</script>
<script src="script.js"></script>
<script src="script-dust.js"></script>
<script src="script-dust-yesterday.js"></script>
<script src="script-humidity.js"></script>
</body></html>
